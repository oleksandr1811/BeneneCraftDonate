<?php
@session_start();

require_once("engine/classes/Main.class.php");
$Engine = new Engine();

if(isset($_POST['unitpay'])) {
    $group_info = $Engine->query_result("SELECT `price`, `group`, `nick` FROM `orders` WHERE `id` = '".$_POST['unitpay']."'");
    $price = $group_info->price;
    $nick = $group_info->nick;


    $desc = "Покупка доната " . $group_info->group . " на сервере Minecraft";
    $signature = hash('SHA256', $_POST['unitpay'] . "*" . $nick . "{up}" . $desc . "{up}" . $price . "{up}" . $Engine->cfg['unitpay']['key']);
    $link = "https://unitpay.ru/pay/{$Engine->cfg['unitpay']['project_id']}/webmoney?sum={$price}&account={$_POST['unitpay']}*{$nick}&desc={$desc}&signature={$signature}";
    
    //$desc = 'Donation';
    //$sign = md5($Engine->cfg['unitpay']['project_id'].':'.$price.':'.$Engine->cfg['unitpay']['key'].':'.$desc);
    //$link = "https://www.free-kassa.ru/merchant/cash.php?m={$Engine->cfg['unitpay']['project_id']}&oa={$price}&o={$desc}&s={$sign}&us_account={$_POST['freekassa']}";
    echo $link;
    die();
}

if(isset($_POST['qiwi'])) {
    $price = $Engine->query_result("SELECT `price` FROM `orders` WHERE `id` = '".$_POST['qiwi']."'");
    $price = $price->price;
    $desc = "Покупка привилегии";

    $link = "https://oplata.qiwi.com/create?publicKey={$Engine->cfg['qiwi']['public_key']}&amount={$price}&account={$_POST['qiwi']}&comment={$desc}&successUrl=https://mixpixel.ru/?success";
    echo $link;
    die();
}

if(isset($_POST['get_id'])) {
    echo $_SESSION['buy_id'];
    unset($_SESSION['buy_id']);
    die();
}

if(!isset($_SESSION['buy_id'])) {
	$Engine->redirect('/');
	die();
}

?>
<!doctype html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/styles/css/select.css">
    <title><?=$Engine->cfg['server']['name']?> > Выбор платежной системы</title>
</head>
<body>
    <div class="center">
        <div class="selector">
            <div class="qiwi">
                <svg class="qiwi_img" width="69" height="71" viewBox="0 0 69 71" xmlns="http://www.w3.org/2000/svg"><path d="M56.6164 47.7297C56.5246 46.9495 56.0632 45.1607 54.8638 44.7013H54.8652C54.2648 44.4717 53.7575 44.6543 53.5282 45.068C53.1585 45.7113 53.4351 46.9495 54.1272 48.0521C54.8179 49.1534 55.4642 49.704 55.9256 49.704C56.3871 49.704 56.8012 49.1534 56.6164 47.7297Z" fill="#FF8C00"></path><path d="M50.1623 50.8508C49.4243 50.2089 48.5946 49.8879 47.8566 49.8879C47.2118 49.8879 46.7045 50.1161 46.3806 50.5298C45.5523 51.5383 45.9206 53.3756 47.2118 54.4769C47.7649 54.9818 48.5946 55.2571 49.3785 55.2571C50.1623 55.2571 50.853 54.9362 51.2686 54.4312C52.0066 53.4213 51.591 52.0447 50.1623 50.8508Z" fill="#FF8C00"></path><path d="M0 31.575C0 49.015 14.1996 63.1513 31.721 63.1513H31.7195C36.3768 63.1513 40.9868 62.2798 47.7649 62.2327C53.805 62.2327 60.4441 64.3439 67.7281 70.7701C68.4661 71.412 69.4333 70.5861 68.7885 69.8058C61.6421 60.7649 55.003 59.0673 48.3639 57.5981C40.2502 55.8079 36.1002 51.3102 33.1955 46.3076C32.6424 45.2976 32.3658 45.4816 32.3185 46.7669C32.2663 48.658 32.4055 50.5495 32.7341 52.4129H31.7668C20.1939 52.4129 10.7877 43.0495 10.7877 31.5293C10.7877 20.0091 20.1939 10.6458 31.7654 10.6458C43.3383 10.6458 52.7446 20.0091 52.7446 31.5293C52.7446 32.3552 52.6973 33.1812 52.6056 33.9614C51.0379 33.6861 48.0415 33.6405 45.9206 33.8245C45.1368 33.9158 45.2285 34.2824 45.8289 34.3751C52.7446 35.6589 57.4936 39.9284 58.5998 47.6841C58.6457 47.8681 58.8764 47.9138 58.9696 47.7768C61.7811 43.0495 63.4405 37.4948 63.4405 31.575C63.4405 14.1363 49.2395 0 31.7195 0C14.2011 0 0 14.1349 0 31.575Z" fill="#FF8C00"></path></svg>
                <p class="qiwi_text">QIWI</p>
            </div>
            <div class="unitpay">
                <svg class="unitpay_img" width="197" height="65" viewBox="0 0 197 65" xmlns="http://www.w3.org/2000/svg"><path d="M34.6558 14.3594V35.2011C34.6558 46.6234 28.6955 50.5218 20.7882 50.5218C12.88 50.5218 6.86133 46.6234 6.86133 35.2011V28.3946C9.04779 28.4218 7.41556 28.4058 11.7589 28.3986V35.3094C11.7589 43.863 15.7129 46.5697 20.7882 46.5697C25.9218 46.5697 29.9351 43.863 29.9351 35.3094V14.3594H34.6558Z" fill="#151C1F"></path><path d="M34.6558 14.3594V35.2011C34.6558 46.6234 28.6955 50.5218 20.7882 50.5218C12.88 50.5218 6.86133 46.6234 6.86133 35.2011V28.3946C9.04779 28.4218 7.41556 28.4058 11.7589 28.3986V35.3094C11.7589 43.863 15.7129 46.5697 20.7882 46.5697C25.9218 46.5697 29.9351 43.863 29.9351 35.3094V14.3594H34.6558Z" fill="#151C1F"></path><path d="M34.6558 14.3594V35.2011C34.6558 46.6234 28.6955 50.5218 20.7882 50.5218C12.88 50.5218 6.86133 46.6234 6.86133 35.2011V28.3946C9.04779 28.4218 7.41556 28.4058 11.7589 28.3986V35.3094C11.7589 43.863 15.7129 46.5697 20.7882 46.5697C25.9218 46.5697 29.9351 43.863 29.9351 35.3094V14.3594H34.6558Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M11.7589 14.3594V21.568C7.42064 21.572 9.05287 21.5816 6.86133 21.5655V14.3594H11.7589Z" fill="#151C1F"></path><path d="M11.7589 14.3594V21.568C7.42064 21.572 9.05287 21.5816 6.86133 21.5655V14.3594H11.7589Z" stroke="#151C1F"></path><path d="M11.7589 14.3594V21.3746C7.42064 21.3786 9.05287 21.3874 6.86133 21.373V14.3594H11.7589Z" fill="#151C1F"></path><path d="M11.7589 14.3594V21.3746C7.42064 21.3786 9.05287 21.3874 6.86133 21.373V14.3594H11.7589Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M42.8008 49.8716H47.6391V30.8161C50.5312 28.1632 52.5375 26.7556 55.488 26.7556C59.2652 26.7556 60.9169 28.8669 60.9169 33.7933V49.8716H65.7561V33.1978C65.7561 26.4852 63.0416 22.9126 57.0221 22.9126C53.0689 22.9126 50.1183 24.861 47.403 27.3511H47.2262L46.8132 23.5618H42.8008V49.8716Z" fill="#151C1F"></path><path d="M42.8008 49.8716H47.6391V30.8161C50.5312 28.1632 52.5375 26.7556 55.488 26.7556C59.2652 26.7556 60.9169 28.8669 60.9169 33.7933V49.8716H65.7561V33.1978C65.7561 26.4852 63.0416 22.9126 57.0221 22.9126C53.0689 22.9126 50.1183 24.861 47.403 27.3511H47.2262L46.8132 23.5618H42.8008V49.8716Z" stroke="#151C1F"></path><path d="M42.8008 49.8716H47.6391V30.8161C50.5312 28.1632 52.5375 26.7556 55.488 26.7556C59.2652 26.7556 60.9169 28.8669 60.9169 33.7933V49.8716H65.7561V33.1978C65.7561 26.4852 63.0416 22.9126 57.0221 22.9126C53.0689 22.9126 50.1183 24.861 47.403 27.3511H47.2262L46.8132 23.5618H42.8008V49.8716Z" fill="#151C1F"></path><path d="M42.8008 49.8716H47.6391V30.8161C50.5312 28.1632 52.5375 26.7556 55.488 26.7556C59.2652 26.7556 60.9169 28.8669 60.9169 33.7933V49.8716H65.7561V33.1978C65.7561 26.4852 63.0416 22.9126 57.0221 22.9126C53.0689 22.9126 50.1183 24.861 47.403 27.3511H47.2262L46.8132 23.5618H42.8008V49.8716Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M79.9192 23.562V49.8718H75.0801V23.562H79.9192Z" fill="#151C1F"></path><path d="M79.9192 23.562V49.8718H75.0801V23.562H79.9192Z" stroke="#151C1F"></path><path d="M79.9192 23.562V49.8718H75.0801V23.562H79.9192Z" fill="#151C1F"></path><path d="M79.9192 23.562V49.8718H75.0801V23.562H79.9192Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M98.626 50.5218C100.397 50.5218 102.344 50.0339 103.937 49.5468L102.993 46.1909C102.049 46.5159 100.751 46.8946 99.7471 46.8946C96.4429 46.8946 95.3217 45.0538 95.3217 41.8054V27.1892H103.052V23.562H95.3217V16.2002H91.25L90.6594 23.562L86.1748 23.8333V27.1892H90.4233V41.7516C90.4233 46.9484 92.4888 50.5218 98.626 50.5218Z" fill="#151C1F"></path><path d="M98.626 50.5218C100.397 50.5218 102.344 50.0339 103.937 49.5468L102.993 46.1909C102.049 46.5159 100.751 46.8946 99.7471 46.8946C96.4429 46.8946 95.3217 45.0538 95.3217 41.8054V27.1892H103.052V23.562H95.3217V16.2002H91.25L90.6594 23.562L86.1748 23.8333V27.1892H90.4233V41.7516C90.4233 46.9484 92.4888 50.5218 98.626 50.5218Z" stroke="#151C1F"></path><path d="M98.626 50.5218C100.397 50.5218 102.344 50.0339 103.937 49.5468L102.993 46.1909C102.049 46.5159 100.751 46.8946 99.7471 46.8946C96.4429 46.8946 95.3217 45.0538 95.3217 41.8054V27.1892H103.052V23.562H95.3217V16.2002H91.25L90.6594 23.562L86.1748 23.8333V27.1892H90.4233V41.7516C90.4233 46.9484 92.4888 50.5218 98.626 50.5218Z" fill="#151C1F"></path><path d="M98.626 50.5218C100.397 50.5218 102.344 50.0339 103.937 49.5468L102.993 46.1909C102.049 46.5159 100.751 46.8946 99.7471 46.8946C96.4429 46.8946 95.3217 45.0538 95.3217 41.8054V27.1892H103.052V23.562H95.3217V16.2002H91.25L90.6594 23.562L86.1748 23.8333V27.1892H90.4233V41.7516C90.4233 46.9484 92.4888 50.5218 98.626 50.5218Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M109.544 60.9697H114.382V52.0912L114.265 47.4898C116.92 49.3845 119.576 50.5216 122.231 50.5216C128.781 50.5216 134.624 45.2702 134.624 36.3379C134.624 28.1632 130.67 22.9126 123.293 22.9126C119.93 22.9126 116.743 24.5906 114.146 26.5935H113.969L113.556 23.5618H109.544V60.9697ZM121.405 46.7861C119.517 46.7861 116.979 46.0277 114.382 44.0248V30.2207C117.215 27.8927 119.634 26.6473 122.054 26.6473C127.483 26.6473 129.608 30.5457 129.608 36.3379C129.608 42.8339 126.126 46.7861 121.405 46.7861Z" fill="#151C1F"></path><path d="M109.544 60.9697H114.382V52.0912L114.265 47.4898C116.92 49.3845 119.576 50.5216 122.231 50.5216C128.781 50.5216 134.624 45.2702 134.624 36.3379C134.624 28.1632 130.67 22.9126 123.293 22.9126C119.93 22.9126 116.743 24.5906 114.146 26.5935H113.969L113.556 23.5618H109.544V60.9697ZM121.405 46.7861C119.517 46.7861 116.979 46.0277 114.382 44.0248V30.2207C117.215 27.8927 119.634 26.6473 122.054 26.6473C127.483 26.6473 129.608 30.5457 129.608 36.3379C129.608 42.8339 126.126 46.7861 121.405 46.7861Z" stroke="#151C1F"></path><path d="M109.544 60.9697H114.382V52.0912L114.265 47.4898C116.92 49.3845 119.576 50.5216 122.231 50.5216C128.781 50.5216 134.624 45.2702 134.624 36.3379C134.624 28.1632 130.67 22.9126 123.293 22.9126C119.93 22.9126 116.743 24.5906 114.146 26.5935H113.969L113.556 23.5618H109.544V60.9697ZM121.405 46.7861C119.517 46.7861 116.979 46.0277 114.382 44.0248V30.2207C117.215 27.8927 119.634 26.6473 122.054 26.6473C127.483 26.6473 129.608 30.5457 129.608 36.3379C129.608 42.8339 126.126 46.7861 121.405 46.7861Z" fill="#151C1F"></path><path d="M109.544 60.9697H114.382V52.0912L114.265 47.4898C116.92 49.3845 119.576 50.5216 122.231 50.5216C128.781 50.5216 134.624 45.2702 134.624 36.3379C134.624 28.1632 130.67 22.9126 123.293 22.9126C119.93 22.9126 116.743 24.5906 114.146 26.5935H113.969L113.556 23.5618H109.544V60.9697ZM121.405 46.7861C119.517 46.7861 116.979 46.0277 114.382 44.0248V30.2207C117.215 27.8927 119.634 26.6473 122.054 26.6473C127.483 26.6473 129.608 30.5457 129.608 36.3379C129.608 42.8339 126.126 46.7861 121.405 46.7861Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M148.079 50.5215C151.678 50.5215 154.865 48.789 157.58 46.7315H157.757L158.17 49.8716H162.182V33.7395C162.182 27.189 159.232 22.9126 152.21 22.9126C147.607 22.9126 143.594 24.7527 140.938 26.3231L142.827 29.4086C145.069 28.0011 148.079 26.5935 151.384 26.5935C156.104 26.5935 157.285 29.8419 157.285 33.1978C145.069 34.4433 139.699 37.3121 139.699 43.0506C139.699 47.7603 143.299 50.5215 148.079 50.5215ZM149.495 46.9482C146.662 46.9482 144.42 45.7035 144.42 42.7256C144.42 39.3696 147.725 37.2038 157.285 36.1212V43.4293C154.511 45.7035 152.269 46.9482 149.495 46.9482Z" fill="#151C1F"></path><path d="M148.079 50.5215C151.678 50.5215 154.865 48.789 157.58 46.7315H157.757L158.17 49.8716H162.182V33.7395C162.182 27.189 159.232 22.9126 152.21 22.9126C147.607 22.9126 143.594 24.7527 140.938 26.3231L142.827 29.4086C145.069 28.0011 148.079 26.5935 151.384 26.5935C156.104 26.5935 157.285 29.8419 157.285 33.1978C145.069 34.4433 139.699 37.3121 139.699 43.0506C139.699 47.7603 143.299 50.5215 148.079 50.5215ZM149.495 46.9482C146.662 46.9482 144.42 45.7035 144.42 42.7256C144.42 39.3696 147.725 37.2038 157.285 36.1212V43.4293C154.511 45.7035 152.269 46.9482 149.495 46.9482Z" stroke="#151C1F"></path><path d="M148.079 50.5215C151.678 50.5215 154.865 48.789 157.58 46.7315H157.757L158.17 49.8716H162.182V33.7395C162.182 27.189 159.232 22.9126 152.21 22.9126C147.607 22.9126 143.594 24.7527 140.938 26.3231L142.827 29.4086C145.069 28.0011 148.079 26.5935 151.384 26.5935C156.104 26.5935 157.285 29.8419 157.285 33.1978C145.069 34.4433 139.699 37.3121 139.699 43.0506C139.699 47.7603 143.299 50.5215 148.079 50.5215ZM149.495 46.9482C146.662 46.9482 144.42 45.7035 144.42 42.7256C144.42 39.3696 147.725 37.2038 157.285 36.1212V43.4293C154.511 45.7035 152.269 46.9482 149.495 46.9482Z" fill="#151C1F"></path><path d="M148.079 50.5215C151.678 50.5215 154.865 48.789 157.58 46.7315H157.757L158.17 49.8716H162.182V33.7395C162.182 27.189 159.232 22.9126 152.21 22.9126C147.607 22.9126 143.594 24.7527 140.938 26.3231L142.827 29.4086C145.069 28.0011 148.079 26.5935 151.384 26.5935C156.104 26.5935 157.285 29.8419 157.285 33.1978C145.069 34.4433 139.699 37.3121 139.699 43.0506C139.699 47.7603 143.299 50.5215 148.079 50.5215ZM149.495 46.9482C146.662 46.9482 144.42 45.7035 144.42 42.7256C144.42 39.3696 147.725 37.2038 157.285 36.1212V43.4293C154.511 45.7035 152.269 46.9482 149.495 46.9482Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M170.732 61.1858C176.516 61.1858 179.466 57.2344 181.472 52.0376L192.272 23.562H187.551L182.417 38.1244C181.65 40.4524 180.823 43.1591 179.997 45.5408H179.761C178.876 43.1053 177.873 40.3978 176.988 38.1244L171.146 23.562H166.13L177.637 49.9263L176.988 51.8747C175.807 55.1231 173.742 57.5049 170.497 57.5049C169.789 57.5049 168.903 57.2882 168.313 57.1261L167.369 60.6449C168.313 60.9699 169.434 61.1858 170.732 61.1858Z" fill="#151C1F"></path><path d="M170.732 61.1858C176.516 61.1858 179.466 57.2344 181.472 52.0376L192.272 23.562H187.551L182.417 38.1244C181.65 40.4524 180.823 43.1591 179.997 45.5408H179.761C178.876 43.1053 177.873 40.3978 176.988 38.1244L171.146 23.562H166.13L177.637 49.9263L176.988 51.8747C175.807 55.1231 173.742 57.5049 170.497 57.5049C169.789 57.5049 168.903 57.2882 168.313 57.1261L167.369 60.6449C168.313 60.9699 169.434 61.1858 170.732 61.1858Z" stroke="#151C1F"></path><path d="M170.732 61.1858C176.516 61.1858 179.466 57.2344 181.472 52.0376L192.272 23.562H187.551L182.417 38.1244C181.65 40.4524 180.823 43.1591 179.997 45.5408H179.761C178.876 43.1053 177.873 40.3978 176.988 38.1244L171.146 23.562H166.13L177.637 49.9263L176.988 51.8747C175.807 55.1231 173.742 57.5049 170.497 57.5049C169.789 57.5049 168.903 57.2882 168.313 57.1261L167.369 60.6449C168.313 60.9699 169.434 61.1858 170.732 61.1858Z" fill="#151C1F"></path><path d="M170.732 61.1858C176.516 61.1858 179.466 57.2344 181.472 52.0376L192.272 23.562H187.551L182.417 38.1244C181.65 40.4524 180.823 43.1591 179.997 45.5408H179.761C178.876 43.1053 177.873 40.3978 176.988 38.1244L171.146 23.562H166.13L177.637 49.9263L176.988 51.8747C175.807 55.1231 173.742 57.5049 170.497 57.5049C169.789 57.5049 168.903 57.2882 168.313 57.1261L167.369 60.6449C168.313 60.9699 169.434 61.1858 170.732 61.1858Z" stroke="#151C1F" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M77.5588 12.41C79.4474 12.4517 80.9231 13.5471 80.9231 15.2796C80.9231 16.9576 79.4474 18.1484 77.5588 18.1484C75.671 18.1484 71.9395 12.5969 71.2498 11.0514C70.9097 10.2906 73.6876 12.3241 77.5588 12.41Z" fill="#429A3A"></path><path d="M77.5588 12.41C79.4474 12.4517 80.9231 13.5471 80.9231 15.2796C80.9231 16.9576 79.4474 18.1484 77.5588 18.1484C75.671 18.1484 71.9395 12.5969 71.2498 11.0514C70.9097 10.2906 73.6876 12.3241 77.5588 12.41Z" stroke="#429A3A" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                <p class="unitpay_text">Другие способы</p>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="/styles/js/selector.js?v=12"></script>
</body>
</html>
